source("http://bioconductor.org/biocLite.R")
biocLite()
source("http://bioconductor.org/biocLite.R")
biocLite()
install.packages('knitr')
require(iris)
require('iris')
data(iris)
iris
l<-tapply(iris[,4],INDEX=list(iris[,5]),FUN=mean)
l
m<-aggregate(iris[,-5],by=list(iris[,5]),FUN=mean)
m
?rowsum
n<-rowsum(iris,[,-5],group=iris[,5])
n<-rowsum(iris[,-5],group=iris[,5])
n
n<-rowsum(iris[,-5])
n<-get.multiple.quotes(iris,from=as.Petal.Width(0.5),to=as.Petal.Width(1.5),interval=0.1)
xyplot(iris[,3]~iris[,4])
library(lattice)
xyplot(iris[,3]~iris[,4])
library(randomforest)
install.packages('randomforest')
install.packages('randomForest')
library(randomForest)
randomForest()
?randomForest()
data(iris)
ind=sample(2,nrow(iris),replace=TRUEï¼Œprob=c(0.8,0.2))
ind=sample(2,nrow(iris),replace=TRUE,prob=c(0.8,0.2))
ind
iris.rf=randomForest(Species~.,iris[ind==1,],ntree=50,nPerm=10,mtry=3,proximity=TRUE,importance=TRUE)
iris.rf
round(c(2,3,4,5,6),0.05)
round(c(2,3,4,5,6),0.5)
round(c(2,3,4,5,6),1)
round(c(2,3,4,5,6),2)
random(c(2,3,4,5),1)
x=c(2,3,3,5,6,7)
y=c(1,1,3,4,5,6)
l<-lm(y~x)
l
l<-lmfit(y~x)
l<-lmFit(y~x)
summary(lm)
summary(l)
plot(x,y)
l$df
predict(l,c(20,30,40))
predict(l,data.frame(c(20,30,40)))
predict(l,data.frame(c(20,30,40)),interval='confidence')
predict(l,data.frame(c(20,30)),interval='confidence')
predict(l,data.frame(c(50,30)),interval='confidence')
predict(l,data.frame(10:20),interval='confidence')
predict(l,data.frame(x=10:20),interval='confidence')
predict(l,data.frame(x=10:20))
install.packages("Vennerable", repos="http://R-Forge.R-project.org")
source("http://bioconductor.org/biocLite.R")
biocLite("RBGL")
source("https://bioconductor.org/biocLite.R")
print('hello world')
```{r}
summary(cars)
library('affy')
```
?plot
# this is my first code
print('hello world')
x=c(1:5)
plot(x)
plot(x)
print('hello world')
x=c(1:5)
plot(x)
dev.off()
print('hello world')
x=c(1:5)
plot(x)
dev.off()
print('hello world')
x=c(1:5)
install.packages("installr")
plot(c(1:5))
a<-matrix(c(1:6),nrow=3)
a
rownames(a)=c("a","b","c")
a
db=data.frame(key=c("a","b","c"),values=c(10:12))
db
merge(rownames(a),db)
rownames(db)=c("a","b","c")
db
db[,1]=c("aa","bb","cc")
merge(a,db,by=rownames)
merge(a,db,by=rowname)
merge(a,db,by=row.names(a))
merge(a,db
)
a
a
db
a[,1]
a[,1]=c("a","b","c")
a
a=a[,1]
a
colnames(a)="key"
a<-data.frame(a)
a
colnames(a)="key"
db
a
db[,1]=c("a","b","d")
merge(a,db,by=key)
merge(a,db,by="key")
t=c("d","d","e","f")
unique(t)
t<-as.data.frame(t)
unique(t)
rm(list=ls())
library(ggplot2)
library(RColorBrewer)
library(grid)
library(dplyr)
library(ROCR)
library(flux)
library(reshape2)
setwd("/Users/apple/Desktop/project/dnase_project/thesis/processing_data/figure3a/")
pr_table1<-read.table("pr_table.txt",sep='\t',header = T)
pr_table2<-read.table("prauc_table.txt",sep='\t')
dnase_table<-subset(pr_table1,length==300&rep=="final")
dnase_table2<-melt(dnase_table[,-c(3,4)],id=c("soft","mark"))
colnames(dnase_table2)[3]<-"tissue"
colnames(pr_table2)<-colnames(dnase_table2)
merge_table<-rbind(dnase_table2, pr_table2[-c(1:5),])
p<-ggplot(merge_table,aes(x=mark, y=value))+xlab(NULL)+ylab("PRAUC value")
plot_title="PRAUC of VISTA enhancer summary"
q<-p+geom_boxplot(width=0.7, position=position_dodge(0.5),alpha=.3,outlier.size = 0.5) +labs(title=plot_title)+theme(panel.grid.major=element_line(colour=NA))+theme(axis.text.x=element_text(angle = 45,hjust=1,size=12))
ggplot_build(q)
View(merge_table)
combine_tab<-subset(merge_table, "combine" %in% mark)
combine_tab<-subset(merge_table, "combine" %in% merge_table$mark)
marks<-c("DNase","H3K4me1","H3K4me2","H3K4me3","H3K9ac","H3K27ac")
combine_tab<-subset(merge_table, merge_table$mark %in% marks)
View(combine_tab)
combine_tab<-subset(merge_table, not merge_table$mark %in% marks)
combine_tab<-subset(merge_table,merge_table$mark %!in% marks)
combine_tab<-subset(merge_table,merge_table$mark %in% marks==FALSE)
View(combine_tab)
mar="DNase"
plot_table<-subset(combine_tab, mark==mar)
p<-ggplot(plot_table, aes(x=tissue, y=value,col=soft,group=soft))+xlab(NULL)+ylab("PRAUC value")
plot_title=paste("VISTA enhancer PRAUC of ",mar," adjusted peaks",sep='')
q<-p+labs(title=plot_title)+geom_line()  +theme(panel.grid.major=element_line(colour=NA)) +theme_set(theme_bw())
outfile<-paste("prauc_combined_",mar,".png",sep='')
ggsave(q, file=outfile,height=3,width=5)
mark2<-levels(combine_tab$mark)
View(combine_tab)
levels(combine_tab$mark)<-unique(combine_tab$mark)
unique(combine_tab$mark)
for (mar in unique(combine_tab$mark)){
plot_table<-subset(combine_tab, mark==mar)
p<-ggplot(plot_table, aes(x=tissue, y=value,col=soft,group=soft))+xlab(NULL)+ylab("PRAUC value")
plot_title=paste("VISTA enhancer PRAUC of ",mar," adjusted peaks",sep='')
q<-p+labs(title=plot_title)+geom_line()  +theme(panel.grid.major=element_line(colour=NA)) +theme_set(theme_bw())
outfile<-paste("prauc_combined_",mar,".png",sep='')
ggsave(q, file=outfile,height=3,width=5)
}
for (mar in unique(combine_tab$mark)){
plot_table<-subset(combine_tab, mark==mar)
p<-ggplot(plot_table, aes(x=tissue, y=value,col=soft,group=soft,linetype=soft))+xlab(NULL)+ylab("PRAUC value")
plot_title=paste("VISTA enhancer PRAUC of ",mar," peaks",sep='')
q<-p+labs(title=plot_title)+geom_line() +scale_linetype_manual(values = c(rep("solid", 6), rep("dashed", 5))) +scale_color_manual(values = c("black", brewer.pal(10, "Paired"))) +theme(panel.grid.major=element_line(colour=NA)) +theme_set(theme_bw())
outfile<-paste("prauc_",mar,".png",sep='')
ggsave(q, file=outfile,height=3,width=7)
}
View(dnase_table2)
View(dnase_table)
View(dnase_table2)
combine_tab2<-rbind(subset(dnase_table2,soft=="DFilter"), combine_tab)
for (mar in unique(combine_tab2$mark)){
plot_table<-subset(combine_tab2, mark==mar)
p<-ggplot(plot_table, aes(x=tissue, y=value,col=soft,group=soft,linetype=soft))+xlab(NULL)+ylab("PRAUC value")
plot_title=paste("VISTA enhancer PRAUC of ",mar," peaks",sep='')
q<-p+labs(title=plot_title)+geom_line() +scale_linetype_manual(values = c(rep("solid", 6), rep("dashed", 5))) +scale_color_manual(values = c("black", brewer.pal(10, "Paired"))) +theme(panel.grid.major=element_line(colour=NA)) +theme_set(theme_bw())
outfile<-paste("prauc_",mar,".png",sep='')
ggsave(q, file=outfile,height=3,width=7)
}
View(combine_tab)
View(dnase_table2)
View(combine_tab2)
temp<-subset(dnase_table2,soft=="DFilter")
View(temp)
View(temp)
temp$soft<-paste(temp$soft,temp$mark,sep='_')
for (mar in unique(combine_tab$mark)){
plot_table<-subset(combine_tab, mark==mar)
plot_table<-rbind(temp,plot_table)
p<-ggplot(plot_table, aes(x=tissue, y=value,col=soft,group=soft,linetype=soft))+xlab(NULL)+ylab("PRAUC value")
plot_title=paste("VISTA enhancer PRAUC of ",mar," peaks",sep='')
q<-p+labs(title=plot_title)+geom_line() +scale_linetype_manual(values = c(rep("solid", 6), rep("dashed", 5))) +scale_color_manual(values = c("black", brewer.pal(10, "Paired"))) +theme(panel.grid.major=element_line(colour=NA)) +theme_set(theme_bw())
outfile<-paste("prauc_",mar,".png",sep='')
ggsave(q, file=outfile,height=3,width=7)
}
View(temp)
View(plot_table)
for (mar in unique(combine_tab$mark)){
plot_table<-subset(combine_tab, mark==mar)
plot_table<-rbind(temp,plot_table)
p<-ggplot(plot_table, aes(x=tissue, y=value,col=soft,group=soft,linetype=soft))+xlab(NULL)+ylab("PRAUC value")
plot_title=paste("VISTA enhancer PRAUC of ",mar," peaks",sep='')
q<-p+labs(title=plot_title)+geom_line() +scale_linetype_manual(values = c(rep("solid", 6), rep("dashed", 6))) +scale_color_manual(values = c("black", brewer.pal(12, "Paired"))) +theme(panel.grid.major=element_line(colour=NA)) +theme_set(theme_bw())
outfile<-paste("prauc_",mar,".png",sep='')
ggsave(q, file=outfile,height=3,width=7)
}
for (mar in unique(combine_tab$mark)){
plot_table<-subset(combine_tab, mark==mar)
plot_table<-rbind(temp,plot_table)
p<-ggplot(plot_table, aes(x=tissue, y=value,col=soft,group=soft,linetype=soft))+xlab(NULL)+ylab("PRAUC value")
plot_title=paste("VISTA enhancer PRAUC of ",mar," peaks",sep='')
q<-p+labs(title=plot_title)+geom_line() +scale_linetype_manual(values = c(rep("solid", 6), rep("dashed", 6))) +scale_color_manual(values = c(brewer.pal(12, "Paired"))) +theme(panel.grid.major=element_line(colour=NA)) +theme_set(theme_bw())
outfile<-paste("prauc_",mar,".png",sep='')
ggsave(q, file=outfile,height=3,width=7)
}
q
marks
levels(combine_tab$soft)
levels(plot_table)<-c("DFilter_DNase",unique(combine_tab$soft))
for (mar in unique(combine_tab$mark)){
plot_table<-subset(combine_tab, mark==mar)
plot_table<-rbind(temp,plot_table)
levels(plot_table)<-c("DFilter_DNase",unique(combine_tab$soft))
p<-ggplot(plot_table, aes(x=tissue, y=value,col=soft,group=soft,linetype=soft))+xlab(NULL)+ylab("PRAUC value")
plot_title=paste("VISTA enhancer PRAUC of ",mar," peaks",sep='')
q<-p+labs(title=plot_title)+geom_line() +scale_linetype_manual(values = c(rep("solid", 6), rep("dashed", 6))) +scale_color_manual(values = c(brewer.pal(12, "Paired"))) +theme(panel.grid.major=element_line(colour=NA)) +theme_set(theme_bw())
outfile<-paste("prauc_",mar,".png",sep='')
ggsave(q, file=outfile,height=3,width=7)
}
for (mar in unique(combine_tab$mark)){
plot_table<-subset(combine_tab, mark==mar)
plot_table<-rbind(temp,plot_table)
levels(plot_table$soft)<-c("DFilter_DNase",unique(combine_tab$soft))
p<-ggplot(plot_table, aes(x=tissue, y=value,col=soft,group=soft,linetype=soft))+xlab(NULL)+ylab("PRAUC value")
plot_title=paste("VISTA enhancer PRAUC of ",mar," peaks",sep='')
q<-p+labs(title=plot_title)+geom_line() +scale_linetype_manual(values = c(rep("solid", 6), rep("dashed", 6))) +scale_color_manual(values = c(brewer.pal(12, "Paired"))) +theme(panel.grid.major=element_line(colour=NA)) +theme_set(theme_bw())
outfile<-paste("prauc_",mar,".png",sep='')
ggsave(q, file=outfile,height=3,width=7)
}
levels(plot_table$soft)
combine_tab$soft
levels(combine_tab$soft)
for (mar in unique(combine_tab$mark)){
plot_table<-subset(combine_tab, mark==mar)
plot_table<-rbind(temp,plot_table)
levels(plot_table$soft)<-c("DFilter_DNase",levels(combine_tab$soft))
p<-ggplot(plot_table, aes(x=tissue, y=value,col=soft,group=soft,linetype=soft))+xlab(NULL)+ylab("PRAUC value")
plot_title=paste("VISTA enhancer PRAUC of ",mar," peaks",sep='')
q<-p+labs(title=plot_title)+geom_line() +scale_linetype_manual(values = c(rep("solid", 6), rep("dashed", 6))) +scale_color_manual(values = c(brewer.pal(12, "Paired"))) +theme(panel.grid.major=element_line(colour=NA)) +theme_set(theme_bw())
outfile<-paste("prauc_",mar,".png",sep='')
ggsave(q, file=outfile,height=3,width=7)
}
levels(combine_tab$soft)
levels(plot_table$soft)
factor(plot_table$soft)
c(plot_table$soft)
for (mar in unique(combine_tab$mark)){
plot_table<-subset(combine_tab, mark==mar)
plot_table<-rbind(temp,plot_table)
levels(plot_table$soft)<-as.factor("DFilter_DNase",levels(combine_tab$soft))
p<-ggplot(plot_table, aes(x=tissue, y=value,col=soft,group=soft,linetype=soft))+xlab(NULL)+ylab("PRAUC value")
plot_title=paste("VISTA enhancer PRAUC of ",mar," peaks",sep='')
q<-p+labs(title=plot_title)+geom_line() +scale_linetype_manual(values = c(rep("solid", 6), rep("dashed", 6))) +scale_color_manual(values = c(brewer.pal(12, "Paired"))) +theme(panel.grid.major=element_line(colour=NA)) +theme_set(theme_bw())
outfile<-paste("prauc_",mar,".png",sep='')
ggsave(q, file=outfile,height=3.5,width=7)
}
for (mar in unique(combine_tab$mark)){
plot_table<-subset(combine_tab, mark==mar)
plot_table<-rbind(temp,plot_table)
levels(plot_table$soft)<-factor("DFilter_DNase",levels(combine_tab$soft))
p<-ggplot(plot_table, aes(x=tissue, y=value,col=soft,group=soft,linetype=soft))+xlab(NULL)+ylab("PRAUC value")
plot_title=paste("VISTA enhancer PRAUC of ",mar," peaks",sep='')
q<-p+labs(title=plot_title)+geom_line() +scale_linetype_manual(values = c(rep("solid", 6), rep("dashed", 6))) +scale_color_manual(values = c(brewer.pal(12, "Paired"))) +theme(panel.grid.major=element_line(colour=NA)) +theme_set(theme_bw())
outfile<-paste("prauc_",mar,".png",sep='')
ggsave(q, file=outfile,height=3.5,width=7)
}
for (mar in unique(combine_tab$mark)){
plot_table<-subset(combine_tab, mark==mar)
plot_table<-rbind(temp,plot_table)
plot_table$soft<-factor(plot_table$soft,levels= c("DFilter_DNase",levels(combine_tab$soft)))
p<-ggplot(plot_table, aes(x=tissue, y=value,col=soft,group=soft,linetype=soft))+xlab(NULL)+ylab("PRAUC value")
plot_title=paste("VISTA enhancer PRAUC of ",mar," peaks",sep='')
q<-p+labs(title=plot_title)+geom_line() +scale_linetype_manual(values = c(rep("solid", 6), rep("dashed", 6))) +scale_color_manual(values = c(brewer.pal(12, "Paired"))) +theme(panel.grid.major=element_line(colour=NA)) +theme_set(theme_bw())
outfile<-paste("prauc_",mar,".png",sep='')
ggsave(q, file=outfile,height=3.5,width=7)
}
combine_tab<-subset(merge_table,merge_table$mark %in% marks==FALSE)
#combine_tab2<-rbind(subset(dnase_table2,soft=="DFilter"), combine_tab)
temp<-subset(dnase_table2,soft=="DFilter")
temp$soft<-paste(temp$soft,temp$mark,sep='_')
for (mar in unique(combine_tab$mark)){
plot_table<-subset(combine_tab, mark==mar)
plot_table<-rbind(temp,plot_table)
plot_table$soft<-factor(plot_table$soft,levels= c("DFilter_DNase",levels(combine_tab$soft)))
p<-ggplot(plot_table, aes(x=tissue, y=value,col=soft,group=soft,linetype=soft))+xlab(NULL)+ylab("PRAUC value")
plot_title=paste("VISTA enhancer PRAUC of ",mar," peaks",sep='')
q<-p+labs(title=plot_title)+geom_line() +scale_linetype_manual(values = c(rep("solid", 6), rep("dashed", 6))) +scale_color_manual("black",values = c(brewer.pal(12, "Paired"))) +theme(panel.grid.major=element_line(colour=NA)) +theme_set(theme_bw())
outfile<-paste("prauc_",mar,".png",sep='')
ggsave(q, file=outfile,height=3.5,width=7)
}
for (mar in unique(combine_tab$mark)){
plot_table<-subset(combine_tab, mark==mar)
plot_table<-rbind(temp,plot_table)
plot_table$soft<-factor(plot_table$soft,levels= c("DFilter_DNase",levels(combine_tab$soft)))
p<-ggplot(plot_table, aes(x=tissue, y=value,col=soft,group=soft,linetype=soft))+xlab(NULL)+ylab("PRAUC value")
plot_title=paste("VISTA enhancer PRAUC of ",mar," peaks",sep='')
q<-p+labs(title=plot_title)+geom_line() +scale_linetype_manual(values = c(rep("solid", 6), rep("dashed", 6))) +scale_color_manual(values = c("black",brewer.pal(12, "Paired"))) +theme(panel.grid.major=element_line(colour=NA)) +theme_set(theme_bw())
outfile<-paste("prauc_",mar,".png",sep='')
ggsave(q, file=outfile,height=3.5,width=7)
}
unique(combine_tab$mark)
rm(list=ls())
library(ggplot2)
library(RColorBrewer)
library(grid)
library(dplyr)
library(ROCR)
library(flux)
setwd("~/Desktop/project/dnase_project/encode/analysis_pipe/select_pipe/bin")
auc_table<-read.table("../results/promoter_pr_table.txt",sep='\t')
auc_table<-data.frame(auc_table)
colnames(auc_table)<-c("soft","mark","tissue","rep","score")
auc_table$score<-as.numeric(as.vector(auc_table$score))
auc_table$rep<-as.factor(auc_table$rep)
marks<-auc_table$mark
mar="DNase"
final_table<-subset(auc_table,rep=='final')
for (mar in marks[-1]){
plot_table<-subset(final_table,mark==mar)
p<-ggplot(plot_table,aes(x=tissue,y=score,group=soft,col=soft,linetype=soft))+xlab(NULL)+ylab(NULL)+theme(axis.text.x=element_text(angle = 45,hjust=1,size=10))+theme(panel.grid.major=element_line(colour=NA))
plot_title<-paste("Promoter PR in",mar,"caller",sep=' ')
q<-p+labs(title=plot_title)+geom_line()+scale_linetype_manual(values = c(rep("solid", 6), rep("dashed", 5))) +scale_color_manual(values = c(brewer.pal(12, "Paired")))
outfile<-paste("../results/promoter_pr_lines_",mar,".pdf",sep='')
ggsave(q,file=outfile,height=3,width=6)
}
